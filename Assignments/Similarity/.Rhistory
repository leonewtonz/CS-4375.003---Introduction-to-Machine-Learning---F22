df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
library(caret)
fit <- knnreg(train[,c(2,3,4,6,7,8,9)],train[,5],k=3)
pred2 <- predict(fit, test[,c(2,3,4,6,7,8,9)])
cor_knn1 <- cor(pred2, test$F5)
mse_knn1 <- mean((pred2 - test$F5)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
dfint <- data.frame(lapply(df, as.integer))
dfint <- data.frame(lapply(df, as.integer))
str(dfint)
set.seed(1234)
i <- sample(1:nrow(dfint), 0.8*nrow(dfint), replace=FALSE)
train <- df[i,]
test <- df[-i,]
set.seed(1234)
i <- sample(1:nrow(dfint), 0.8*nrow(dfint), replace=FALSE)
train <- df[i,]
test <- df[-i,]
fit <- knnreg(train[,c(2,3,4,6,7,8,9)],train[,5],k=3)
pred2 <- predict(fit, test[,c(2,3,4,6,7,8,9)])
cor_knn1 <- cor(pred2, test$F5)
mse_knn1 <- mean((pred2 - test$F5)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
fit <- knnreg(train[,c(2,3,4,6,7,8,9)],train[,5],k=5)
pred2 <- predict(fit, test[,c(2,3,4,6,7,8,9)])
cor_knn1 <- cor(pred2, test$F5)
mse_knn1 <- mean((pred2 - test$F5)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
pred2 <- predict(fit, test[,c(2,3,4,6)])
fit <- knnreg(train[,c(2,3,4,6)],train[,5],k=3)
pred2 <- predict(fit, test[,c(2,3,4,6)])
cor_knn1 <- cor(pred2, test$F5)
mse_knn1 <- mean((pred2 - test$F5)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
library(caret)
fit <- knnreg(train[,3:10],train[,3],k=3)
fit <- knnreg(train[,3:10],train[,3],k=3)
pred2 <- predict(fit, test[,c(2,3,4,6)])
pred2 <- predict(fit, test[,3:10])
cor_knn1 <- cor(pred2, test$F5)
mse_knn1 <- mean((pred2 - test$F5)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
pred2 <- predict(fit, test[,3:10])
cor_knn1 <- cor(pred2, test$F1)
mse_knn1 <- mean((pred2 - test$F1)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
fit <- knnreg(train[,3:10],train[,3],k=3)
summary(fit)
dfint <- data.frame(lapply(df, as.integer))
str(dfint)
set.seed(1234)
i <- sample(1:nrow(dfint), 0.8*nrow(dfint), replace=FALSE)
train <- df[i,]
test <- df[-i,]
pred2 <- predict(fit, test[,3:10])
cor_knn1 <- cor(pred2, test$F1)
mse_knn1 <- mean((pred2 - test$F1)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
head(train, n=10)
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
head(train, n=10)
colSums(is.na(train))
summary(train$F1)
summary(train$F5)
lm1 <- lm(F1~F5, data = train)
summary(lm1)
pred1 <- predict(lm1, newdata=test)
cor1 <- cor(pred1, test$F1)
mse1 <- mean((pred1-test$F1)^2)
rmse1 <- sqrt(mse1)
print(paste('correlation:', cor1))
print(paste('mse:', mse1))
print(paste('rmse:', rmse1))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
library(caret)
fit <- knnreg(train[,3:10],train[,3],k=3)
summary(fit)
pred2 <- predict(fit, test[,3:10])
cor_knn1 <- cor(pred2, test$F1)
mse_knn1 <- mean((pred2 - test$F1)^2)
print(paste("cor=", cor_knn1))
print(paste("mse=", mse_knn1))
train_scaled <- train[, 3:10]  # omit name and don't scale mpg
means <- sapply(train_scaled, mean)
stdvs <- sapply(train_scaled, sd)
train_scaled <- scale(train_scaled, center=means, scale=stdvs)
test_scaled <- scale(test[, 3:10], center=means, scale=stdvs)
fit <- knnreg(train_scaled, train$mpg, k=3)
fit <- knnreg(train_scaled, train$F1, k=3)
pred3 <- predict(fit, test_scaled)
cor_knn2 <- cor(pred3, test$F1)
mse_knn2 <- mean((pred3 - test$F1)^2)
print(paste("cor=", cor_knn2))
print(paste("mse=", mse_knn2))
print(paste("rmse=", sqrt(mse_knn2)))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
head(train, n=10)
summary(train)
colSums(is.na(train))
cor(train)
pairs(train)
summary(train$F1)
summary(train$F5)
plot(train$F5,train$F1 ,xlab = "F5 - Molecular mass weighted exposed area.", ylab = "F1 - Total surface area." )
hist(train$F1, xlab = "F1 - Total surface area", main = "Total surface are of Protein Tertiary Structure")
lm3 <- lm(F1~., data=train)
summary(lm3)
lm <- lm(F1~., data=train)
summary(lm)
pred1 <- predict(lm1, newdata=test)
pred1 <- predict(lm, newdata=test)
cor1 <- cor(pred1, test$F1)
mse1 <- mean((pred1-test$F1)^2)
rmse1 <- sqrt(mse1)
print(paste('correlation:', cor1))
print(paste('mse:', mse1))
print(paste('rmse:', rmse1))
pred1 <- predict(lm, newdata=test)
cor_lm <- cor(pred1, test$F1)
mse_lm <- mean((pred1-test$F1)^2)
rmse_lm <- sqrt(mse1)
print(paste('correlation:', cor_lm))
print(paste('mse:', mse_lm))
print(paste('rmse:', rmse_lm))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
head(train, n=10)
summary(train)
colSums(is.na(train))
cor(train)
pairs(train)
summary(train$F1)
summary(train$F5)
plot(train$F5,train$F1 ,xlab = "F5 - Molecular mass weighted exposed area.", ylab = "F1 - Total surface area." )
hist(train$F1, xlab = "F1 - Total surface area", main = "Total surface are of Protein Tertiary Structure")
lm <- lm(F1~., data=train)
summary(lm)
pred1 <- predict(lm, newdata=test)
cor_lm <- cor(pred1, test$F1)
mse_lm <- mean((pred1-test$F1)^2)
rmse_lm <- sqrt(mse1)
pred1 <- predict(lm, newdata=test)
cor_lm <- cor(pred1, test$F1)
mse_lm <- mean((pred1-test$F1)^2)
rmse_lm <- sqrt(mse_lm)
print(paste('correlation:', cor_lm))
print(paste('mse:', mse_lm))
print(paste('rmse:', rmse_lm))
rm pred1
rm(pred1)
pred_lm <- predict(lm, newdata=test)
cor_lm <- cor(pred1, test$F1)
pred_lm <- predict(lm, newdata=test)
cor_lm <- cor(pred_lm, test$F1)
mse_lm <- mean((pred_lm-test$F1)^2)
rmse_lm <- sqrt(mse_lm)
print(paste('correlation:', cor_lm))
print(paste('mse:', mse_lm))
print(paste('rmse:', rmse_lm))
pred_lm <- predict(lm, newdata=test)
cor_lm <- cor(pred_lm, test$F1)
mse_lm <- mean((pred_lm-test$F1)^2)
rmse_lm <- sqrt(mse_lm)
print(paste('Linear Regression correlation:', cor_lm))
print(paste('Linear Regression mse:', mse_lm))
print(paste('Linear Regression rmse:', rmse_lm))
pred_lm <- predict(lm, newdata=test)
cor_lm <- cor(pred_lm, test$F1)
mse_lm <- mean((pred_lm-test$F1)^2)
rmse_lm <- sqrt(mse_lm)
print(paste('correlation:', cor_lm))
print(paste('mse:', mse_lm))
print(paste('rmse:', rmse_lm))
lm <- lm(F1~., data=train)
summary(lm)
library(caret)
fit <- knnreg(train[,3:10],train[,3],k=3)
summary(fit)
library(caret)
``
library(caret)
df = subset(df, select = -c(RMSD) )
df = subset(df, select = -c(RMSD))
df <- read.csv("data/CASP.csv", header=TRUE)
str(df)
df = subset(df, select = -c(RMSD))
str(df)
set.seed(1234)
i <- sample(1:nrow(df), 0.8*nrow(df), replace=FALSE)
train <- df[i,]
test <- df[-i,]
head(train, n=10)
summary(train)
colSums(is.na(train))
cor(train)
summary(train$F1)
summary(train$F5)
plot(train$F5,train$F1 ,xlab = "F5 - Molecular mass weighted exposed area.", ylab = "F1 - Total surface area." )
hist(train$F1, xlab = "F1 - Total surface area", main = "Total surface are of Protein Tertiary Structure")
lm <- lm(F1~., data=train)
summary(lm)
pred_lm <- predict(lm, newdata=test)
cor_lm <- cor(pred_lm, test$F1)
mse_lm <- mean((pred_lm-test$F1)^2)
rmse_lm <- sqrt(mse_lm)
print(paste('correlation:', cor_lm))
print(paste('mse:', mse_lm))
print(paste('rmse:', rmse_lm))
library(caret)
fit <- knnreg(train[,2:9],train[,1],k=3)
fit <- knnreg(train[,2:9],train[,1],k=3)
pred_knn <- predict(fit, test[,2:9])
cor_knn <- cor(pred_knn, test$F1)
mse_knn <- mean((pred_knn - test$F1)^2)
rmse_lm <- sqrt(mse_knn)
print(paste('correlation:', cor_knn))
print(paste('mse:', mse_knn))
print(paste('rmse:', rmse_knn))
pred_knn <- predict(fit, test[,2:9])
cor_knn <- cor(pred_knn, test$F1)
mse_knn <- mean((pred_knn - test$F1)^2)
rmse_knn <- sqrt(mse_knn)
print(paste('correlation:', cor_knn))
print(paste('mse:', mse_knn))
print(paste('rmse:', rmse_knn))
train_scaled <- train[, 2:9]
means <- sapply(train_scaled, mean)
stdvs <- sapply(train_scaled, sd)
train_scaled <- scale(train_scaled, center=means, scale=stdvs)
test_scaled <- scale(test[, 2:9], center=means, scale=stdvs)
fit_scaled <- knnreg(train_scaled, train$F1, k=3)
pred_scaled <- predict(fit_scaled, test_scaled)
cor_scaled <- cor(pred_scaled, test$F1)
mse_scaled <- mean((pred_scaled - test$F1)^2)
rmse_scaled <- sqrt(mse_scaled)
print(paste('correlation:', cor_scaled))
print(paste('mse:', mse_scaled))
print(paste('rmse:', rmse_scaled))
tree <- tree(train$F1~., data=train)
library(tree)
tree <- tree(train$F1~., data=train)
summary(tree)
pred_tree <- predict(tree, newdata=test)
cor_tree <- cor(pred_tree, test$F1)
mse_tree <- mean((pred_tree - test$F1)^2)
rmse_tree <- sqrt(mse_tree)
print(paste('correlation:', cor_tree))
print(paste('mse:', mse_tree))
print(paste('rmse:', rmse_tree))
plot(tree1)
plot(tree)
text(tree, cex=0.5, pretty=0)
tree <- tree(F1~., data=train)
summary(tree)
tree <- tree(F1~F3+F4., data=train)
df_origin <- read.csv("data/Skin Segmentation.csv", header=TRUE)
str(df_origin)
dim(df_origin)
set.seed(1234)
df <- df_origin[sample(1:nrow(df_origin), 10000, replace = FALSE),]
str(df)
dim(df)
df$Skin <- factor(df$Skin)
levels(df$Skin) <- c("Skin", "NonSkin")
str(df)
set.seed(1234)
groups <- c(train=.6, test=.2, validate=.2)
i <- sample(cut(1:nrow(df),
nrow(df)*cumsum(c(0,groups)), labels=names(groups)))
train <- df[i=="train",]
test <- df[i=="test",]
vald <- df[i=="validate",]
head(train, n=10)
summary(train)
